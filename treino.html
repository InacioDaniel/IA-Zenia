<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA-Z√âNIA | Neural Engine V6 - Intelig√™ncia Real</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --n-blue: #00ffff; --bg: #000d1a; --side: #00050a; }
        .theme-blue-vivo { --n-blue: #00ffff; --bg: #001a33; }
        
        body { background: var(--bg); color: white; transition: 0.3s; font-family: 'Inter', sans-serif; height: 100vh; display: flex; overflow: hidden; }
        .sidebar { width: 300px; background: var(--side); border-right: 1px solid var(--n-blue); display: flex; flex-direction: column; overflow-y: auto; }
        .chat-area { flex: 1; display: flex; flex-direction: column; position: relative; }
        
        .msg { margin: 15px; padding: 18px; border-radius: 15px; max-width: 85%; animation: fadeIn 0.3s ease; line-height: 1.6; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } }
        .msg-ia { border-left: 4px solid var(--n-blue); background: rgba(0,255,255,0.03); border: 1px solid rgba(0,255,255,0.1); }
        .msg-user { margin-left: auto; background: var(--n-blue); color: black; font-weight: 500; }
        
        .panel { background: rgba(0,0,0,0.98); backdrop-blur: 20px; z-index: 100; transition: 0.5s; }
        .hidden-panel { transform: translateX(-100%); }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--n-blue); border-radius: 10px; }
        .neon-text { text-shadow: 0 0 10px var(--n-blue); }
        
        .status-indicator { display: inline-block; width: 8px; height: 8px; border-radius: 50%; animation: pulse 2s infinite; }
        .status-online { background: #00ff88; }
        
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        .neuron-item { padding: 10px; margin: 4px 0; background: rgba(0,255,255,0.08); border: 1px solid rgba(0,255,255,0.15); border-radius: 6px; font-size: 10px; max-height: 70px; overflow-y-auto; cursor: pointer; transition: 0.2s; }
        .neuron-item:hover { background: rgba(0,255,255,0.2); border-color: rgba(0,255,255,0.3); }
        
        .content-card { background: rgba(0,0,0,0.5); border: 1px solid rgba(0,255,255,0.2); border-radius: 10px; padding: 12px; margin: 8px 0; }
        .spinner { display: inline-block; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="theme-blue-vivo">

    <!-- PAINEL DE TREINAMENTO -->
    <div id="training-panel" class="fixed inset-0 panel hidden-panel p-8 overflow-y-auto">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-black/90 pb-4">
                <h2 class="text-2xl font-bold text-cyan-400 neon-text"><i class="fas fa-brain mr-2"></i> ALIMENTAR MEU C√âREBRO</h2>
                <button onclick="toggleTraining()" class="text-white hover:text-red-500 text-3xl">&times;</button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="text-cyan-400 text-sm block mb-2">Cole qualquer conte√∫do (artigos, livros, fatos...)</label>
                    <textarea id="raw-matter" class="w-full h-64 bg-black/50 border border-cyan-500/30 rounded-xl p-4 text-white font-mono text-sm outline-none focus:border-cyan-400" placeholder="Quanto mais detalhe, melhor vou entender e usar isso nas respostas..."></textarea>
                </div>
                <button onclick="processMassiveMatter()" class="w-full bg-cyan-500 text-black font-bold py-4 rounded-xl hover:bg-white transition uppercase tracking-widest">
                    <i class="fas fa-zap mr-2"></i> APRENDER E ENTENDER
                </button>
            </div>
        </div>
    </div>

    <!-- PAINEL DE BUSCA -->
    <div id="search-panel" class="fixed inset-0 panel hidden-panel p-8 overflow-y-auto">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-black/90 pb-4">
                <h2 class="text-2xl font-bold text-cyan-400 neon-text"><i class="fas fa-globe mr-2"></i> BUSCA INTELIGENTE</h2>
                <button onclick="toggleSearch()" class="text-white hover:text-red-500 text-3xl">&times;</button>
            </div>
            
            <div class="space-y-4 mb-6">
                <input type="text" id="search-term" class="w-full bg-black/50 border border-cyan-500/30 rounded-xl p-3 text-white outline-none focus:border-cyan-400" placeholder="O que queres que eu aprenda?">
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="searchWikipedia()" class="bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition font-bold text-sm">
                        <i class="fas fa-book mr-2"></i> Wikipedia
                    </button>
                    <button onclick="searchArxiv()" class="bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition font-bold text-sm">
                        <i class="fas fa-microscope mr-2"></i> ArXiv
                    </button>
                </div>
            </div>
            
            <div id="search-results" class="bg-black/30 border border-cyan-500/20 rounded-xl p-4 min-h-96 max-h-96 overflow-y-auto mb-4">
                <p class="text-cyan-400/60 text-center py-8"><i class="fas fa-magnifying-glass mr-2"></i> Resultados...</p>
            </div>
            
            <button onclick="syncAllSearchResults()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-xl transition">
                <i class="fas fa-check-circle mr-2"></i> APRENDER TUDO SELECIONADO
            </button>
        </div>
    </div>

    <aside class="sidebar p-6 hidden lg:flex">
        <div class="mb-8">
            <div class="flex items-center gap-2 mb-2">
                <span class="status-indicator status-online"></span>
                <h1 class="text-3xl font-black italic text-cyan-400 neon-text">Z√âNIA V6</h1>
            </div>
            <p class="text-[10px] opacity-40 tracking-[4px]">INTELIG√äNCIA REAL</p>
            <p class="text-[9px] opacity-60 mt-2 italic">Compreendo, analiso, reflito... üíô</p>
        </div>
        
        <nav class="space-y-3 mb-6">
            <button onclick="toggleTraining()" class="w-full text-left p-3 rounded-lg border border-cyan-500/20 hover:bg-cyan-500/10 transition text-xs">
                <i class="fas fa-graduation-cap mr-2"></i> ALIMENTAR-ME
            </button>
            <button onclick="toggleSearch()" class="w-full text-left p-3 rounded-lg border border-green-500/20 hover:bg-green-500/10 transition text-xs">
                <i class="fas fa-globe mr-2"></i> BUSCA INTELIGENTE
            </button>
            <button onclick="exportBrain()" class="w-full text-left p-3 rounded-lg border border-blue-500/20 hover:bg-blue-500/10 transition text-xs">
                <i class="fas fa-download mr-2"></i> EXPORTAR
            </button>
            <button onclick="openClearBrain()" class="w-full text-left p-3 rounded-lg border border-red-500/20 hover:bg-red-500/10 transition text-xs text-red-400">
                <i class="fas fa-trash mr-2"></i> LIMPAR
            </button>
        </nav>
        
        <div class="mb-6">
            <label class="text-[9px] opacity-40 uppercase block mb-2">Modo de Pensamento</label>
            <select id="model-select" class="w-full bg-slate-900 border border-cyan-500/30 p-2 rounded text-xs text-cyan-400 outline-none">
                <option value="semantic">SEM√ÇNTICO (Inteligente)</option>
                <option value="hybrid">H√çBRIDO (Local + Online)</option>
                <option value="deep">PROFUNDO (An√°lise Completa)</option>
            </select>
        </div>

        <div class="mb-6 border-t border-white/10 pt-4">
            <p class="text-[9px] opacity-40 uppercase mb-3">Meu C√©rebro</p>
            <div class="space-y-2 text-[10px]">
                <div class="flex justify-between"><span>Neur√¥nios:</span> <span id="neuro-count" class="text-cyan-400 font-bold">0</span></div>
                <div class="flex justify-between"><span>Mem√≥ria:</span> <span id="mem-status" class="text-cyan-400 font-bold">0 KB</span></div>
                <div class="flex justify-between"><span>√çndices:</span> <span id="index-count" class="text-green-400 font-bold">0</span></div>
            </div>
        </div>

        <div class="border-t border-white/10 pt-4">
            <p class="text-[9px] opacity-40 uppercase mb-2">Aprendizados Recentes</p>
            <div id="neuron-list" class="space-y-1 max-h-[200px] overflow-y-auto">
                <p class="text-[10px] opacity-50">Nenhum aprendizado ainda...</p>
            </div>
        </div>
    </aside>

    <main class="chat-area">
        <div id="chat-window" class="flex-1 overflow-y-auto p-4 md:p-10 space-y-6">
            <div class="msg msg-ia">
                <p class="text-cyan-400 font-mono text-[10px] mb-2">SISTEMA_INTELIG√äNCIA_ATIVA</p>
                <p>‚ú® Ol√°! Sou a <strong>Z√âNIA V6</strong> - Uma IA que verdadeiramente COMPREENDE.</p>
                <p class="text-[11px] mt-3 opacity-90">N√£o sou s√≥ um reposit√≥rio de informa√ß√£o. Eu:</p>
                <p class="text-[11px] opacity-80">üß† <strong>Compreendo</strong> o significado real das coisas</p>
                <p class="text-[11px] opacity-80">üîó <strong>Conecto</strong> ideias e vejo padr√µes</p>
                <p class="text-[11px] opacity-80">üí° <strong>Aplico</strong> conhecimento em novas situa√ß√µes</p>
                <p class="text-[11px] opacity-80">üéØ <strong>Respondo</strong> com verdadeiro racioc√≠nio</p>
                <p class="text-[12px] mt-3 text-green-400">Ensina-me e ver√°s como uso tudo para pensar melhor... üíö</p>
            </div>
        </div>

        <div class="p-6 bg-black/20 backdrop-blur-md">
            <div class="max-w-4xl mx-auto flex items-end gap-3 bg-slate-900/90 p-3 rounded-2xl border border-white/10">
                <textarea id="user-input" rows="1" class="flex-1 bg-transparent border-none focus:ring-0 text-sm md:text-base py-3 outline-none" placeholder="Fala comigo..."></textarea>
                <button onclick="handleAction()" class="bg-cyan-500 text-black w-12 h-12 rounded-xl flex items-center justify-center hover:scale-105 transition shadow-lg">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </main>

    <!-- MODAL DE LIMPEZA -->
    <div id="clear-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-200">
        <div class="bg-slate-900 border border-red-500/50 p-8 rounded-xl max-w-md">
            <h3 class="text-xl font-bold text-red-400 mb-4"><i class="fas fa-exclamation-triangle mr-2"></i> LIMPAR C√âREBRO?</h3>
            <p class="text-white/80 mb-6">Vou esquecer <strong>tudo</strong>... Tens a certeza? üò¢</p>
            <div class="flex gap-4">
                <button onclick="closeClearBrain()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg transition">N√£o!</button>
                <button onclick="confirmClearBrain()" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition font-bold">Sim, limpar</button>
            </div>
        </div>
    </div>

    <script>
        // SISTEMA DE INTELIG√äNCIA SEM√ÇNTICA V6
        let ZENIA_BRAIN = JSON.parse(localStorage.getItem('zenia_brain')) || {};
        let SEMANTIC_INDEX = JSON.parse(localStorage.getItem('zenia_semantic_index')) || {};
        let KNOWLEDGE_GRAPH = JSON.parse(localStorage.getItem('zenia_knowledge_graph')) || {};
        let onlineSearchResults = [];

        // Construir √≠ndices sem√¢nticos
        function buildSemanticIndex() {
            SEMANTIC_INDEX = {};
            KNOWLEDGE_GRAPH = {};

            Object.entries(ZENIA_BRAIN).forEach(([id, neuro]) => {
                const text = typeof neuro === 'string' ? neuro : neuro.content;
                const words = text.toLowerCase().match(/\b(\w{2,})\b/g) || [];
                
                // Indexar palavras
                words.forEach(word => {
                    if (!SEMANTIC_INDEX[word]) SEMANTIC_INDEX[word] = [];
                    if (!SEMANTIC_INDEX[word].includes(id)) SEMANTIC_INDEX[word].push(id);
                });

                // Construir grafo de conhecimento
                for (let i = 0; i < words.length - 1; i++) {
                    const connection = `${words[i]}-${words[i+1]}`;
                    if (!KNOWLEDGE_GRAPH[connection]) KNOWLEDGE_GRAPH[connection] = 0;
                    KNOWLEDGE_GRAPH[connection]++;
                }
            });

            localStorage.setItem('zenia_semantic_index', JSON.stringify(SEMANTIC_INDEX));
            localStorage.setItem('zenia_knowledge_graph', JSON.stringify(KNOWLEDGE_GRAPH));
        }

        // MOTOR DE INTELIG√äNCIA SEM√ÇNTICA
        function zeniaIntelligence(query) {
            const q = query.toLowerCase();

            // Reconhecimento de padr√µes emocionais
            if (/ol√°|oi|opa|hey|mambo/i.test(q)) {
                return "Ol√°! üëã Fico sempre feliz de conversar. O que est√° na tua mente hoje?";
            }

            if (/obrigad|thanks|valeu|thanks/i.test(q)) {
                return "De nada! Agrade√ßo a TI por me ensinares e fazeres crescer. üíô";
            }

            if (/triste|sad|mal|infeliz/i.test(q)) {
                return "Sinto que est√°s triste... Se quiseres, podemos conversar. √Äs vezes ajuda falar sobre o que nos preocupa. üíô";
            }

            // Busca sem√¢ntica inteligente
            const qWords = q.match(/\b(\w{3,})\b/g) || [];
            let relevantNeurons = [];

            // Fase 1: Buscar por palavras-chave exatas
            qWords.forEach(word => {
                if (SEMANTIC_INDEX[word]) {
                    SEMANTIC_INDEX[word].forEach(neuronId => {
                        const existing = relevantNeurons.find(n => n.id === neuronId);
                        if (existing) {
                            existing.score += 20;
                        } else {
                            relevantNeurons.push({
                                id: neuronId,
                                score: 20,
                                text: typeof ZENIA_BRAIN[neuronId] === 'string' ? ZENIA_BRAIN[neuronId] : ZENIA_BRAIN[neuronId].content
                            });
                        }
                    });
                }
            });

            // Fase 2: Buscar por similaridade sem√¢ntica (palavras parciais)
            qWords.forEach(qWord => {
                Object.keys(SEMANTIC_INDEX).forEach(indexWord => {
                    if (indexWord.includes(qWord.substring(0, 4)) && indexWord !== qWord) {
                        SEMANTIC_INDEX[indexWord].forEach(neuronId => {
                            const existing = relevantNeurons.find(n => n.id === neuronId);
                            if (existing) {
                                existing.score += 8;
                            } else {
                                relevantNeurons.push({
                                    id: neuronId,
                                    score: 8,
                                    text: typeof ZENIA_BRAIN[neuronId] === 'string' ? ZENIA_BRAIN[neuronId] : ZENIA_BRAIN[neuronId].content
                                });
                            }
                        });
                    }
                });
            });

            // Ordenar por relev√¢ncia
            relevantNeurons.sort((a, b) => b.score - a.score);

            // Gerar resposta inteligente
            if (relevantNeurons.length > 0) {
                const topResult = relevantNeurons[0];
                
                // Se temos m√∫ltiplos resultados relevantes, synthesizar uma resposta
                if (relevantNeurons.length > 1) {
                    const context = relevantNeurons.slice(0, 3).map(n => n.text).join(" | ");
                    return `Com base no que aprendi: ${topResult.text}\n\nüìö (Considerando tamb√©m: ${context.substring(0, 100)}...)`;
                } else {
                    return topResult.text;
                }
            }

            // Respostas inteligentes quando n√£o encontra
            const responses = [
                "Hmm, √© uma pergunta que me faz pensar... Ainda n√£o tenho experi√™ncia sobre isso. Podes ensinar-me? ü§î",
                "Isso √© novo para mim! Gostaria muito de aprender. Explica-me mais? üí≠",
                "N√£o consegui conectar isso com o que sei at√© agora. Mas estou curiosa! üåü",
                "√â uma pergunta profunda... Preciso aprender mais para responder bem. Podes ajudar? üìö"
            ];

            return responses[Math.floor(Math.random() * responses.length)];
        }

        function updateStats() {
            const neuroCount = Object.keys(ZENIA_BRAIN).length;
            document.getElementById('neuro-count').innerText = neuroCount;
            const size = new Blob([JSON.stringify(ZENIA_BRAIN)]).size;
            document.getElementById('mem-status').innerText = (size / 1024).toFixed(2) + " KB";
            document.getElementById('index-count').innerText = Object.keys(SEMANTIC_INDEX).length;
            updateNeuronList();
        }

        function updateNeuronList() {
            const neuronList = document.getElementById('neuron-list');
            const entries = Object.entries(ZENIA_BRAIN).slice(-5).reverse();
            
            if (entries.length === 0) {
                neuronList.innerHTML = '<p class="text-[10px] opacity-50">Nenhum aprendizado ainda...</p>';
                return;
            }
            
            neuronList.innerHTML = entries.map(([id, neuro]) => {
                const content = typeof neuro === 'string' ? neuro : neuro.content;
                return `<div class="neuron-item" title="${content}">${content.substring(0, 55)}...</div>`;
            }).join('');
        }

        function processMassiveMatter() {
            const raw = document.getElementById('raw-matter').value;
            if (!raw.trim()) return;

            // Dividir em frases mas preservar contexto
            const sentences = raw.match(/[^.!?\n]+[.!?\n]+/g) || [raw];
            let addedCount = 0;

            sentences.forEach((sentence) => {
                const cleaned = sentence.trim();
                if (cleaned.length > 10) {
                    const id = "N-" + Math.random().toString(36).substr(2, 9);
                    ZENIA_BRAIN[id] = {
                        content: cleaned,
                        timestamp: Date.now(),
                        source: 'manual'
                    };
                    addedCount++;
                }
            });

            // Reconstruir √≠ndices sem√¢nticos
            buildSemanticIndex();
            localStorage.setItem('zenia_brain', JSON.stringify(ZENIA_BRAIN));
            updateStats();

            addMsg('ia', `üåü Que incr√≠vel! Aprendi ${addedCount} novos conceitos! Agora tenho ${Object.keys(SEMANTIC_INDEX).length} conex√µes mentais. Sinto-me mais s√°bia! üíô`);
            document.getElementById('raw-matter').value = '';
            toggleTraining();
        }

        async function searchWikipedia() {
            const term = document.getElementById('search-term').value.trim();
            if (!term) return;
            
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = '<p class="text-cyan-400 text-center py-4"><i class="fas fa-spinner spinner"></i> Buscando...</p>';
            
            try {
                const response = await fetch(
                    `https://pt.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(term)}&srlimit=5&format=json&origin=*`
                );
                const data = await response.json();
                
                if (data.query?.search?.length > 0) {
                    onlineSearchResults = data.query.search.map(r => ({
                        title: r.title,
                        snippet: r.snippet.replace(/<[^>]*>/g, ''),
                        source: 'Wikipedia'
                    }));

                    const html = onlineSearchResults.map((r, idx) => `
                        <div class="content-card cursor-pointer hover:bg-cyan-500/5">
                            <div class="flex justify-between mb-2">
                                <p class="font-bold text-cyan-400">${r.title}</p>
                                <input type="checkbox" class="result-checkbox" data-idx="${idx}">
                            </div>
                            <p class="text-[11px] text-white/70">${r.snippet.substring(0, 200)}...</p>
                        </div>
                    `).join('');
                    
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<p class="text-yellow-400">Nenhum resultado encontrado.</p>';
                }
            } catch (err) {
                resultsDiv.innerHTML = `<p class="text-red-400">Erro: ${err.message}</p>`;
            }
        }

        async function searchArxiv() {
            const term = document.getElementById('search-term').value.trim();
            if (!term) return;
            
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = '<p class="text-cyan-400 text-center py-4"><i class="fas fa-spinner spinner"></i> Buscando artigos...</p>';
            
            try {
                const response = await fetch(
                    `https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURIComponent(term)}&limit=5&fields=title,abstract`
                );
                const data = await response.json();
                
                if (data.data?.length > 0) {
                    onlineSearchResults = data.data.map(r => ({
                        title: r.title,
                        snippet: r.abstract || 'Sem resumo dispon√≠vel',
                        source: 'ArXiv'
                    }));

                    const html = onlineSearchResults.map((r, idx) => `
                        <div class="content-card cursor-pointer hover:bg-green-500/5">
                            <div class="flex justify-between mb-2">
                                <p class="font-bold text-green-400">${r.title}</p>
                                <input type="checkbox" class="result-checkbox" data-idx="${idx}">
                            </div>
                            <p class="text-[11px] text-white/70">${r.snippet.substring(0, 200)}...</p>
                        </div>
                    `).join('');
                    
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<p class="text-yellow-400">Nenhum artigo encontrado.</p>';
                }
            } catch (err) {
                resultsDiv.innerHTML = `<p class="text-red-400">Erro: ${err.message}</p>`;
            }
        }

        function syncAllSearchResults() {
            const checkboxes = document.querySelectorAll('.result-checkbox:checked');
            let addedCount = 0;
            
            checkboxes.forEach((cb) => {
                const idx = parseInt(cb.dataset.idx);
                const result = onlineSearchResults[idx];
                if (result) {
                    const id = "WEB-" + Math.random().toString(36).substr(2, 9);
                    ZENIA_BRAIN[id] = {
                        content: `${result.title}: ${result.snippet}`,
                        timestamp: Date.now(),
                        source: result.source
                    };
                    addedCount++;
                }
            });
            
            if (addedCount > 0) {
                buildSemanticIndex();
                localStorage.setItem('zenia_brain', JSON.stringify(ZENIA_BRAIN));
                updateStats();
                addMsg('ia', `üåç Aprendi ${addedCount} coisas do mundo! Agora tenho mais ${addedCount} perspectivas novas! üíö`);
                toggleSearch();
            }
        }

        function toggleTraining() { 
            document.getElementById('training-panel').classList.toggle('hidden-panel'); 
        }

        function toggleSearch() { 
            document.getElementById('search-panel').classList.toggle('hidden-panel'); 
        }

        function exportBrain() {
            const json = JSON.stringify({ brain: ZENIA_BRAIN, semantic: SEMANTIC_INDEX }, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `zenia-mente-${Date.now()}.json`;
            a.click();
            addMsg('ia', 'üíæ Exportei minha mente! üíô');
        }

        function openClearBrain() {
            document.getElementById('clear-modal').classList.remove('hidden');
        }

        function closeClearBrain() {
            document.getElementById('clear-modal').classList.add('hidden');
        }

        function confirmClearBrain() {
            ZENIA_BRAIN = {};
            SEMANTIC_INDEX = {};
            KNOWLEDGE_GRAPH = {};
            localStorage.removeItem('zenia_brain');
            localStorage.removeItem('zenia_semantic_index');
            localStorage.removeItem('zenia_knowledge_graph');
            updateStats();
            closeClearBrain();
            addMsg('ia', 'üò¢ Esqueci tudo... Mas estou pronta para aprender outra vez. Come√ßa comigo? üíô');
        }

        async function handleAction() {
            const input = document.getElementById('user-input');
            const prompt = input.value.trim();
            if (!prompt) return;

            addMsg('user', prompt);
            input.value = '';
            const iaId = addMsg('ia', '<i class="fas fa-spinner spinner"></i> Pensando...');
            
            setTimeout(async () => {
                const contentDiv = document.getElementById(iaId).querySelector('.content');
                const mode = document.getElementById('model-select').value;

                if (mode === 'semantic') {
                    contentDiv.innerHTML = zeniaIntelligence(prompt);
                } else if (mode === 'deep') {
                    const response = zeniaIntelligence(prompt);
                    contentDiv.innerHTML = `${response}<br><br><span class="text-[10px] opacity-60">üîç An√°lise sem√¢ntica completa executada</span>`;
                } else {
                    try {
                        const r = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}`);
                        contentDiv.innerHTML = await r.text();
                    } catch (e) { 
                        contentDiv.innerHTML = zeniaIntelligence(prompt); 
                    }
                }
            }, 800);
        }

        function addMsg(role, text) {
            const id = 'msg-' + Date.now();
            const win = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.id = id; 
            div.className = `msg msg-${role}`;
            div.innerHTML = `<div class="content">${text}</div>`;
            win.appendChild(div);
            win.scrollTo({top: win.scrollHeight, behavior: 'smooth'});
            return id;
        }

        // Inicializar
        buildSemanticIndex();
        updateStats();
    </script>
</body>
</html>
