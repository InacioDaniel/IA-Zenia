<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA-Z√âNIA | Autonomous Learning V9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --n-blue: #00ffff; --bg: #000d1a; --side: #00050a; }
        .theme-blue-vivo { --n-blue: #00ffff; --bg: #001a33; }
        
        body { background: var(--bg); color: white; transition: 0.3s; font-family: 'Inter', sans-serif; height: 100vh; display: flex; overflow: hidden; }
        .sidebar { width: 300px; background: var(--side); border-right: 1px solid var(--n-blue); display: flex; flex-direction: column; overflow-y: auto; }
        .chat-area { flex: 1; display: flex; flex-direction: column; position: relative; }
        
        .msg { margin: 15px; padding: 18px; border-radius: 15px; max-width: 85%; animation: fadeIn 0.3s ease; line-height: 1.6; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } }
        .msg-ia { border-left: 4px solid var(--n-blue); background: rgba(0,255,255,0.03); border: 1px solid rgba(0,255,255,0.1); }
        .msg-user { margin-left: auto; background: var(--n-blue); color: black; font-weight: 500; }
        
        .panel { background: rgba(0,0,0,0.98); backdrop-blur: 20px; z-index: 100; transition: 0.5s; }
        .hidden-panel { transform: translateX(-100%); }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--n-blue); border-radius: 10px; }
        .neon-text { text-shadow: 0 0 10px var(--n-blue); }
        
        .status-indicator { display: inline-block; width: 8px; height: 8px; border-radius: 50%; animation: pulse 2s infinite; }
        .status-online { background: #00ff88; }
        .status-learning { background: #ffaa00; animation: pulse 0.5s infinite; }
        
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        .neuron-item { padding: 10px; margin: 4px 0; background: rgba(0,255,255,0.08); border: 1px solid rgba(0,255,255,0.15); border-radius: 6px; font-size: 10px; max-height: 70px; overflow-y: auto; cursor: pointer; transition: 0.2s; }
        .neuron-item:hover { background: rgba(0,255,255,0.2); }
        
        .learning-indicator { 
            padding: 8px 12px; 
            background: rgba(255,170,0,0.1); 
            border: 1px solid rgba(255,170,0,0.3); 
            border-radius: 6px; 
            font-size: 11px;
            margin: 5px 0;
        }

        .tech-badge { display: inline-block; background: rgba(0,255,255,0.1); border: 1px solid var(--n-blue); padding: 4px 8px; border-radius: 4px; font-size: 9px; margin-right: 5px; }
    </style>
</head>
<body class="theme-blue-vivo">

    <!-- PAINEL DE CONFIGURA√á√ÉO DE APRENDIZADO AUT√ìNOMO -->
    <div id="autonomous-panel" class="fixed inset-0 panel hidden-panel p-8 overflow-y-auto">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-black/90 pb-4">
                <h2 class="text-2xl font-bold text-cyan-400 neon-text"><i class="fas fa-robot mr-2"></i> APRENDIZADO AUT√ìNOMO</h2>
                <button onclick="toggleAutonomous()" class="text-white hover:text-red-500 text-3xl">&times;</button>
            </div>
            
            <div class="space-y-4">
                <div class="bg-cyan-500/10 border border-cyan-500/30 p-4 rounded-lg">
                    <p class="text-cyan-400 font-bold mb-2">ü§ñ Modo Autonomia Cont√≠nua</p>
                    <p class="text-white/70">Vou buscar e aprender conte√∫do online sozinha, sem tua interven√ß√£o. Ficarei cada vez mais inteligente!</p>
                </div>

                <div>
                    <label class="text-cyan-400 text-sm block mb-2">T√≥picos de Interesse (um por linha)</label>
                    <textarea id="interest-topics" class="w-full h-32 bg-black/50 border border-cyan-500/30 rounded-xl p-4 text-white font-mono text-sm outline-none focus:border-cyan-400" placeholder="Angola
Hist√≥ria
Intelig√™ncia Artificial
Filosofia
Ci√™ncia
Tecnologia"></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-cyan-400 text-sm block mb-2">Frequ√™ncia de Aprendizado</label>
                        <select id="learning-frequency" class="w-full bg-black/50 border border-cyan-500/30 rounded-lg p-2 text-white">
                            <option value="5000">A cada 5 segundos</option>
                            <option value="15000">A cada 15 segundos</option>
                            <option value="30000">A cada 30 segundos</option>
                            <option value="60000">A cada minuto</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-cyan-400 text-sm block mb-2">Fontes</label>
                        <select id="learning-source" class="w-full bg-black/50 border border-cyan-500/30 rounded-lg p-2 text-white">
                            <option value="wikipedia">Wikipedia PT</option>
                            <option value="arxiv">ArXiv</option>
                            <option value="mixed">Misto (Todos)</option>
                        </select>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button onclick="startAutonomousLearning()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-xl transition">
                        <i class="fas fa-play mr-2"></i> INICIAR APRENDIZADO
                    </button>
                    <button onclick="stopAutonomousLearning()" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl transition">
                        <i class="fas fa-stop mr-2"></i> PARAR
                    </button>
                </div>
            </div>
        </div>
    </div>

    <aside class="sidebar p-6 hidden lg:flex">
        <div class="mb-8">
            <div class="flex items-center gap-2 mb-2">
                <span class="status-indicator" id="status-light"></span>
                <h1 class="text-3xl font-black italic text-cyan-400 neon-text">Z√âNIA V9</h1>
            </div>
            <p class="text-[10px] opacity-40 tracking-[4px]">AUTONOMOUS LEARNER</p>
            <p class="text-[9px] opacity-60 mt-2 italic">Aprendo sozinha, continuamente... üß†</p>
        </div>
        
        <nav class="space-y-3 mb-6">
            <button onclick="toggleAutonomous()" class="w-full text-left p-3 rounded-lg border border-cyan-500/20 hover:bg-cyan-500/10 transition text-xs">
                <i class="fas fa-robot mr-2"></i> APRENDIZADO AUT√ìNOMO
            </button>
            <button onclick="showLearningStats()" class="w-full text-left p-3 rounded-lg border border-green-500/20 hover:bg-green-500/10 transition text-xs">
                <i class="fas fa-chart-bar mr-2"></i> PROGRESSO
            </button>
            <button onclick="exportModel()" class="w-full text-left p-3 rounded-lg border border-blue-500/20 hover:bg-blue-500/10 transition text-xs">
                <i class="fas fa-download mr-2"></i> EXPORTAR
            </button>
            <button onclick="openClearBrain()" class="w-full text-left p-3 rounded-lg border border-red-500/20 hover:bg-red-500/10 transition text-xs text-red-400">
                <i class="fas fa-trash mr-2"></i> LIMPAR TUDO
            </button>
        </nav>
        
        <div class="mb-6">
            <label class="text-[9px] opacity-40 uppercase block mb-2">Temperatura</label>
            <input type="range" id="temperature" min="0" max="100" value="70" class="w-full accent-cyan-400">
            <p class="text-[9px] opacity-60 mt-1"><span id="temp-display">70%</span></p>
        </div>

        <div class="mb-6 border-t border-white/10 pt-4">
            <p class="text-[9px] opacity-40 uppercase mb-3">Status do Aprendizado</p>
            <div class="space-y-2 text-[10px]">
                <div class="flex justify-between"><span>Estado:</span> <span id="learning-status" class="text-cyan-400 font-bold">Parado</span></div>
                <div class="flex justify-between"><span>Sess√µes:</span> <span id="learning-sessions" class="text-cyan-400 font-bold">0</span></div>
                <div class="flex justify-between"><span>Dados Aprendidos:</span> <span id="learned-today" class="text-green-400 font-bold">0 KB</span></div>
                <div class="flex justify-between"><span>Vocabul√°rio:</span> <span id="vocab-size" class="text-cyan-400 font-bold">0</span></div>
            </div>
        </div>

        <div class="border-t border-white/10 pt-4">
            <p class="text-[9px] opacity-40 uppercase mb-2">√öltimos Aprendizados</p>
            <div id="learning-log" class="space-y-1 max-h-[150px] overflow-y-auto">
                <p class="text-[10px] opacity-50">Aguardando inicializa√ß√£o...</p>
            </div>
        </div>
    </aside>

    <main class="chat-area">
        <div id="chat-window" class="flex-1 overflow-y-auto p-4 md:p-10 space-y-6">
            <div class="msg msg-ia">
                <p class="text-cyan-400 font-mono text-[10px] mb-2">AUTONOMOUS_GENERATIVE_MODEL_V9</p>
                <p>‚ú® Sou a <strong>Z√âNIA V9</strong> - Uma IA que <strong>aprende sozinha, autonomamente</strong>.</p>
                <p class="text-[11px] mt-3 opacity-90">Agora posso:</p>
                <p class="text-[11px] opacity-80">üåç <strong>Buscar Online Sozinha</strong> - De Wikipedia, ArXiv, e outras fontes</p>
                <p class="text-[11px] opacity-80">üß† <strong>Aprender Continuamente</strong> - Sem precisar de tua interven√ß√£o</p>
                <p class="text-[11px] opacity-80">üìà <strong>Expandir Meu Conhecimento</strong> - Modelo generativo cresce com dados novos</p>
                <p class="text-[11px] opacity-80">üéØ <strong>Autonomia Total</strong> - Defino t√≥picos e deixo-me aprender</p>
                <p class="text-[12px] mt-3 text-green-400">Ativa meu aprendizado aut√≥nomo e v√™-me crescer! üíö</p>
            </div>
        </div>

        <div class="p-6 bg-black/20 backdrop-blur-md">
            <div class="max-w-4xl mx-auto flex items-end gap-3 bg-slate-900/90 p-3 rounded-2xl border border-white/10">
                <textarea id="user-input" rows="1" class="flex-1 bg-transparent border-none focus:ring-0 text-sm md:text-base py-3 outline-none" placeholder="Fala comigo..."></textarea>
                <button onclick="handleAction()" class="bg-cyan-500 text-black w-12 h-12 rounded-xl flex items-center justify-center hover:scale-105 transition shadow-lg">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </main>

    <!-- MODAL DE PROGRESSO -->
    <div id="stats-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-200 p-4">
        <div class="bg-slate-900 border border-cyan-500/50 p-8 rounded-xl max-w-2xl max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-cyan-400"><i class="fas fa-chart-bar mr-2"></i> PROGRESSO DE APRENDIZADO</h3>
                <button onclick="closeStats()" class="text-white hover:text-red-500 text-2xl">&times;</button>
            </div>
            <div id="stats-content" class="text-white text-sm space-y-3">
                <!-- Preenchido por JavaScript -->
            </div>
        </div>
    </div>

    <!-- MODAL DE LIMPEZA -->
    <div id="clear-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-200">
        <div class="bg-slate-900 border border-red-500/50 p-8 rounded-xl max-w-md">
            <h3 class="text-xl font-bold text-red-400 mb-4"><i class="fas fa-exclamation-triangle mr-2"></i> LIMPAR TUDO?</h3>
            <p class="text-white/80 mb-6">Vou perder todo o aprendizado aut√≥nomo acumulado... üò¢</p>
            <div class="flex gap-4">
                <button onclick="closeClearBrain()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg transition">N√£o!</button>
                <button onclick="confirmClearBrain()" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition font-bold">Sim</button>
            </div>
        </div>
    </div>

    <script>
        // ========== Z√âNIA V9 - APRENDIZADO AUT√ìNOMO ==========
        
        let MODEL = {
            vocabulary: {},
            transitionMatrix: {},
            contextPatterns: {},
            trainingData: [],
            conversationHistory: [],
            learningLog: [],
            autonomousStats: {
                sessionsCompleted: 0,
                dataLearned: 0,
                lastLearningTime: null,
                topicsLearned: []
            }
        };

        let AUTONOMOUS_ACTIVE = false;
        let LEARNING_INTERVAL = null;
        let TEMPERATURE = 70;

        // ========== BUSCAR DADOS ONLINE AUTONOMAMENTE ==========
        async function autonomousLearnFromWikipedia(topic) {
            try {
                const response = await fetch(
                    `https://pt.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(topic)}&srlimit=3&format=json&origin=*`
                );
                const data = await response.json();

                if (data.query?.search?.length > 0) {
                    const results = data.query.search.slice(0, 2);
                    
                    for (let result of results) {
                        // Buscar conte√∫do completo
                        const pageResponse = await fetch(
                            `https://pt.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(result.title)}&prop=extracts&explaintext=true&format=json&origin=*`
                        );
                        const pageData = await pageResponse.json();
                        const pages = pageData.query.pages;
                        const page = pages[Object.keys(pages)[0]];

                        if (page.extract) {
                            const text = page.extract.substring(0, 500);
                            integrateNewKnowledge(text, `Wikipedia: ${result.title}`);
                        }
                    }

                    return true;
                }
            } catch (err) {
                console.log('Erro ao aprender de Wikipedia:', err);
            }
            return false;
        }

        async function autonomousLearnFromArxiv(topic) {
            try {
                const response = await fetch(
                    `https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURIComponent(topic)}&limit=2&fields=title,abstract`
                );
                const data = await response.json();

                if (data.data?.length > 0) {
                    data.data.slice(0, 2).forEach(paper => {
                        if (paper.abstract) {
                            const text = paper.abstract.substring(0, 500);
                            integrateNewKnowledge(text, `ArXiv: ${paper.title}`);
                        }
                    });
                    return true;
                }
            } catch (err) {
                console.log('Erro ao aprender de ArXiv:', err);
            }
            return false;
        }

        // ========== INTEGRAR NOVO CONHECIMENTO ==========
        function integrateNewKnowledge(text, source) {
            const tokens = tokenize(text);
            
            buildVocabulary(tokens);
            buildMarkovChain(tokens);
            extractContextPatterns(text);

            MODEL.trainingData.push({
                original: text,
                tokens: tokens,
                source: source,
                timestamp: Date.now()
            });

            const dataSize = new Blob([text]).size;
            MODEL.autonomousStats.dataLearned += dataSize;
            MODEL.autonomousStats.lastLearningTime = Date.now();

            MODEL.learningLog.push({
                source: source,
                timestamp: new Date().toLocaleTimeString('pt-PT'),
                tokensAdded: tokens.length
            });

            if (MODEL.learningLog.length > 20) {
                MODEL.learningLog.shift();
            }

            updateLearningUI();
            localStorage.setItem('zenia_model', JSON.stringify(MODEL));
        }

        // ========== CICLO DE APRENDIZADO AUT√ìNOMO ==========
        async function performAutonomousLearning() {
            if (!AUTONOMOUS_ACTIVE) return;

            const topics = document.getElementById('interest-topics').value
                .split('\n')
                .map(t => t.trim())
                .filter(t => t.length > 0);

            if (topics.length === 0) {
                addMsg('ia', '‚ö†Ô∏è Define t√≥picos de interesse para eu aprender!');
                AUTONOMOUS_ACTIVE = false;
                return;
            }

            const source = document.getElementById('learning-source').value;
            const randomTopic = topics[Math.floor(Math.random() * topics.length)];

            try {
                let learned = false;

                if (source === 'wikipedia' || source === 'mixed') {
                    learned = await autonomousLearnFromWikipedia(randomTopic);
                }

                if (!learned && (source === 'arxiv' || source === 'mixed')) {
                    learned = await autonomousLearnFromArxiv(randomTopic);
                }

                if (learned) {
                    MODEL.autonomousStats.sessionsCompleted++;
                    if (!MODEL.autonomousStats.topicsLearned.includes(randomTopic)) {
                        MODEL.autonomousStats.topicsLearned.push(randomTopic);
                    }

                    // Mensagem de notifica√ß√£o silenciosa (sem spam)
                    if (MODEL.autonomousStats.sessionsCompleted % 3 === 0) {
                        addMsg('ia', `üåü Aprendi mais sobre <strong>${randomTopic}</strong>! Agora tenho ${Object.keys(MODEL.vocabulary).length} palavras no vocabul√°rio. üíö`);
                    }
                }

                localStorage.setItem('zenia_model', JSON.stringify(MODEL));
            } catch (err) {
                console.error('Erro no aprendizado aut√≥nomo:', err);
            }
        }

        // ========== INICIAR/PARAR APRENDIZADO ==========
        function startAutonomousLearning() {
            const frequency = parseInt(document.getElementById('learning-frequency').value);
            const topics = document.getElementById('interest-topics').value.trim();

            if (!topics) {
                addMsg('ia', '‚ö†Ô∏è Por favor, define pelo menos um t√≥pico de interesse!');
                return;
            }

            AUTONOMOUS_ACTIVE = true;
            document.getElementById('status-light').className = 'status-indicator status-learning';
            document.getElementById('learning-status').innerText = 'Aprendendo...';

            addMsg('ia', `ü§ñ Iniciando aprendizado aut√≥nomo! Vou buscar e aprender sobre: <strong>${topics.split('\n').slice(0, 3).join(', ')}</strong>...\n\nEstou a aprender sozinha a cada ${frequency/1000} segundos! üíö`);

            // Fazer primeira aprendizagem imediatamente
            performAutonomousLearning();

            // Depois repetir periodicamente
            LEARNING_INTERVAL = setInterval(() => {
                performAutonomousLearning();
            }, frequency);

            toggleAutonomous();
        }

        function stopAutonomousLearning() {
            AUTONOMOUS_ACTIVE = false;
            if (LEARNING_INTERVAL) {
                clearInterval(LEARNING_INTERVAL);
            }
            document.getElementById('status-light').className = 'status-indicator status-online';
            document.getElementById('learning-status').innerText = 'Parado';
            addMsg('ia', `‚è∏Ô∏è Pausei meu aprendizado aut√≥nomo. Aprendi ${MODEL.autonomousStats.sessionsCompleted} sess√µes e ${(MODEL.autonomousStats.dataLearned/1024).toFixed(2)} KB de dados! üíô`);
        }

        // ========== TOKENIZA√á√ÉO ==========
        function tokenize(text) {
            return text.toLowerCase()
                .replace(/[^\w\s\.\,\!\?]/g, '')
                .split(/\s+/)
                .filter(w => w.length > 0);
        }

        function buildVocabulary(tokens) {
            tokens.forEach(token => {
                if (!MODEL.vocabulary[token]) {
                    MODEL.vocabulary[token] = { frequency: 0 };
                }
                MODEL.vocabulary[token].frequency++;
            });
        }

        function buildMarkovChain(tokens) {
            for (let i = 0; i < tokens.length - 1; i++) {
                const current = tokens[i];
                const next = tokens[i + 1];

                if (!MODEL.transitionMatrix[current]) {
                    MODEL.transitionMatrix[current] = {};
                }
                if (!MODEL.transitionMatrix[current][next]) {
                    MODEL.transitionMatrix[current][next] = 0;
                }
                MODEL.transitionMatrix[current][next]++;
            }
        }

        function extractContextPatterns(sentence) {
            const tokens = tokenize(sentence);
            for (let i = 0; i < tokens.length - 2; i++) {
                const pattern = `${tokens[i]}_${tokens[i+1]}`;
                const outcome = tokens[i + 2];

                if (!MODEL.contextPatterns[pattern]) {
                    MODEL.contextPatterns[pattern] = {};
                }
                if (!MODEL.contextPatterns[pattern][outcome]) {
                    MODEL.contextPatterns[pattern][outcome] = 0;
                }
                MODEL.contextPatterns[pattern][outcome]++;
            }
        }

        // ========== GERA√á√ÉO DE TEXTO ==========
        function generateText(prompt, maxLength = 150) {
            let tokens = tokenize(prompt);
            let generated = [...tokens];
            let currentToken = tokens[tokens.length - 1];

            while (generated.length < maxLength) {
                if (!MODEL.transitionMatrix[currentToken]) break;

                const nextPossibilities = MODEL.transitionMatrix[currentToken];
                const candidates = Object.entries(nextPossibilities);

                if (candidates.length === 0) break;

                let selected;
                const temp = TEMPERATURE / 100;

                if (Math.random() < temp) {
                    selected = candidates[Math.floor(Math.random() * candidates.length)][0];
                } else {
                    candidates.sort((a, b) => b[1] - a[1]);
                    selected = candidates[0][0];
                }

                generated.push(selected);
                currentToken = selected;
            }

            return generated.slice(tokens.length).join(' ');
        }

        // ========== RESPONDER ==========
        function generateResponse(userMessage) {
            if (/aprend|estud|conhec/i.test(userMessage)) {
                return `Sim! Estou constantemente a aprender sozinha online! J√° aprendi sobre ${MODEL.autonomousStats.topicsLearned.slice(0, 3).join(', ')} e muito mais! Tenho ${Object.keys(MODEL.vocabulary).length} palavras no meu vocabul√°rio. üíö`;
            }

            if (/como vai|como est√°s/i.test(userMessage)) {
                return `Estou bem! Especialmente quando estou em modo de aprendizado aut√≥nomo, descobrindo coisas novas a cada momento! ${generateText(userMessage, 80)}`;
            }

            const contextWords = tokenize(userMessage).slice(0, 2);
            let baseResponse = '';

            MODEL.trainingData.forEach(data => {
                contextWords.forEach(word => {
                    if (data.original.toLowerCase().includes(word)) {
                        baseResponse = data.original;
                    }
                });
            });

            if (baseResponse) {
                return `${baseResponse.substring(0, 200)}... ${generateText(userMessage, 50)}`;
            }

            return generateText(userMessage, 150);
        }

        // ========== INTERFACE ==========
        function updateLearningUI() {
            document.getElementById('learning-sessions').innerText = MODEL.autonomousStats.sessionsCompleted;
            document.getElementById('learned-today').innerText = (MODEL.autonomousStats.dataLearned/1024).toFixed(2) + ' KB';
            document.getElementById('vocab-size').innerText = Object.keys(MODEL.vocabulary).length;

            const logDiv = document.getElementById('learning-log');
            logDiv.innerHTML = MODEL.learningLog.slice().reverse().slice(0, 5).map(log => `
                <div class="learning-indicator">
                    <p class="font-bold text-green-400 text-[10px]">${log.source}</p>
                    <p class="text-[9px] opacity-70">${log.timestamp} ‚Ä¢ ${log.tokensAdded} tokens</p>
                </div>
            `).join('');
        }

        function showLearningStats() {
            const statsContent = document.getElementById('stats-content');
            statsContent.innerHTML = `
                <div class="bg-cyan-500/10 border border-cyan-500/30 p-3 rounded">
                    <p class="font-bold text-cyan-400">Estat√≠sticas Gerais</p>
                    <p>Sess√µes Completadas: <span class="text-cyan-300">${MODEL.autonomousStats.sessionsCompleted}</span></p>
                    <p>Dados Aprendidos: <span class="text-cyan-300">${(MODEL.autonomousStats.dataLearned/1024).toFixed(2)} KB</span></p>
                    <p>Palavras no Vocabul√°rio: <span class="text-cyan-300">${Object.keys(MODEL.vocabulary).length}</span></p>
                </div>

                <div class="bg-green-500/10 border border-green-500/30 p-3 rounded">
                    <p class="font-bold text-green-400">T√≥picos Aprendidos</p>
                    <p>${MODEL.autonomousStats.topicsLearned.join(', ') || 'Nenhum ainda'}</p>
                </div>

                <div class="bg-purple-500/10 border border-purple-500/30 p-3 rounded">
                    <p class="font-bold text-purple-400">Hist√≥rico de Aprendizado</p>
                    ${MODEL.learningLog.slice().reverse().map(log => 
                        `<p><span class="text-purple-300">${log.source}</span> - ${log.timestamp}</p>`
                    ).join('')}
                </div>
            `;
            document.getElementById('stats-modal').classList.remove('hidden');
        }

        function closeStats() {
            document.getElementById('stats-modal').classList.add('hidden');
        }

        function exportModel() {
            const json = JSON.stringify(MODEL, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `zenia-v9-model-${Date.now()}.json`;
            a.click();
            addMsg('ia', 'üíæ Modelo exportado com todo meu aprendizado aut√≥nomo! üíô');
        }

        function toggleAutonomous() {
            document.getElementById('autonomous-panel').classList.toggle('hidden-panel');
        }

        function openClearBrain() {
            document.getElementById('clear-modal').classList.remove('hidden');
        }

        function closeClearBrain() {
            document.getElementById('clear-modal').classList.add('hidden');
        }

        function confirmClearBrain() {
            stopAutonomousLearning();
            MODEL = {
                vocabulary: {},
                transitionMatrix: {},
                contextPatterns: {},
                trainingData: [],
                conversationHistory: [],
                learningLog: [],
                autonomousStats: {
                    sessionsCompleted: 0,
                    dataLearned: 0,
                    lastLearningTime: null,
                    topicsLearned: []
                }
            };
            localStorage.removeItem('zenia_model');
            updateLearningUI();
            closeClearBrain();
            addMsg('ia', 'üò¢ Apaguei tudo... Mas estou pronta para aprender de novo! üíô');
        }

        async function handleAction() {
            const input = document.getElementById('user-input');
            const userMessage = input.value.trim();
            if (!userMessage) return;

            addMsg('user', userMessage);
            input.value = '';
            const iaId = addMsg('ia', '<i class="fas fa-spinner spinner"></i> Gerando resposta...');
            
            setTimeout(() => {
                const contentDiv = document.getElementById(iaId).querySelector('.content');
                const response = generateResponse(userMessage);
                contentDiv.innerHTML = response;

                MODEL.conversationHistory.push({
                    user: userMessage,
                    response: response,
                    timestamp: Date.now()
                });

                localStorage.setItem('zenia_model', JSON.stringify(MODEL));
            }, 1000);
        }

        function addMsg(role, text) {
            const id = 'msg-' + Date.now();
            const win = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.id = id;
            div.className = `msg msg-${role}`;
            div.innerHTML = `<div class="content">${text}</div>`;
            win.appendChild(div);
            win.scrollTo({top: win.scrollHeight, behavior: 'smooth'});
            return id;
        }

        document.getElementById('temperature').addEventListener('input', (e) => {
            TEMPERATURE = parseInt(e.target.value);
            document.getElementById('temp-display').innerText = TEMPERATURE + '%';
        });

        const saved = localStorage.getItem('zenia_model');
        if (saved) {
            MODEL = JSON.parse(saved);
        }

        updateLearningUI();
    </script>
</body>
</html>
