<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA-Z√âNIA - Angola 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background: #010409; color: #e6edf3; font-family: 'Plus Jakarta Sans', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; margin: 0; }
        .chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 24px; }
        .glass { background: rgba(13, 17, 23, 0.9); backdrop-filter: blur(10px); border: 1px solid #30363d; }
        .msg-wrapper { display: flex; flex-direction: column; gap: 8px; max-width: 85%; position: relative; }
        .user-wrapper { align-self: flex-end; }
        .ai-wrapper { align-self: flex-start; }
        .msg { padding: 16px; border-radius: 20px; line-height: 1.6; border: 1px solid #30363d; background: #0d1117; }
        .user-msg { background: #1f6feb; border: none; color: white; }
        .tools { display: flex; gap: 10px; margin-top: 4px; opacity: 0.6; }
        .tool-btn { font-size: 10px; cursor: pointer; color: #8b949e; background: #21262d; padding: 4px 8px; border-radius: 6px; border: 1px solid #30363d; transition: 0.2s; }
        .tool-btn:hover { color: #58a6ff; background: #30363d; }
        #canvas-output { background: #000; border-radius: 15px; margin-top: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); width: 100%; max-width: 400px; }
        .preview-img { width: 80px; height: 80px; object-fit: cover; border-radius: 10px; margin-bottom: 10px; border: 2px solid #3b82f6; }
    </style>
</head>
<body>

    <div class="max-w-6xl mx-auto w-full h-full flex flex-col p-2 md:p-6">
        <header class="flex justify-between items-center mb-4 px-2">
            <div>
                <h1 class="text-3xl font-black text-white tracking-tighter">IA-Z√âNIA</h1>
                <p class="text-[10px] text-blue-500 font-bold uppercase">Creative Neural Canvas | Dev @inacio.u.daniel</p>
            </div>
        </header>

        <div id="chatBox" class="chat-container">
            <div class="msg-wrapper ai-wrapper">
                <div class="msg ai-msg text-sm">
                    <b>IA-Z√âNIA Ativa.</b> Posso analisar imagens que voc√™ carregar ou <b>desenhar artes originais via pixels</b> usando meu motor gr√°fico interno. Como vamos criar hoje?
                </div>
            </div>
        </div>

        <div id="uploadPreview" class="hidden px-4 py-2">
            <img id="imgToAnalyze" src="" class="preview-img">
            <button onclick="clearUpload()" class="text-xs text-red-400 font-bold">Remover Imagem</button>
        </div>

        <div class="mt-auto p-2">
            <div class="glass rounded-3xl flex items-center p-2 border-[#30363d] shadow-2xl">
                <input type="file" id="fileInput" class="hidden" accept="image/*" onchange="previewFile()">
                <button onclick="document.getElementById('fileInput').click()" class="p-3 hover:bg-white/5 rounded-full transition">üñºÔ∏è</button>
                <input type="text" id="userInput" placeholder="Pe√ßa para eu desenhar algo ou tire uma d√∫vida..." class="flex-1 bg-transparent border-none outline-none text-sm p-2 text-white">
                <button onclick="handleSend()" class="bg-[#238636] hover:bg-[#2ea043] text-white px-6 py-3 rounded-2xl font-bold transition">ENVIAR</button>
            </div>
        </div>
    </div>

    <script>
        const chatBox = document.getElementById('chatBox');
        const userInput = document.getElementById('userInput');
        const fileInput = document.getElementById('fileInput');
        let selectedImgBase64 = null;

        function previewFile() {
            const file = fileInput.files[0];
            const reader = new FileReader();
            reader.onloadend = () => {
                selectedImgBase64 = reader.result;
                document.getElementById('imgToAnalyze').src = reader.result;
                document.getElementById('uploadPreview').classList.remove('hidden');
            }
            if (file) reader.readAsDataURL(file);
        }

        function clearUpload() {
            selectedImgBase64 = null;
            document.getElementById('uploadPreview').classList.add('hidden');
            fileInput.value = "";
        }

        // --- MOTOR DE DESENHO PIXEL-ART NEURAL ---
        function drawNeuralArt(instructions) {
            const canvas = document.createElement('canvas');
            canvas.id = "canvas-output";
            canvas.width = 400; canvas.height = 400;
            const ctx = canvas.getContext('2d');
            
            // Simula√ß√£o de renderiza√ß√£o avan√ßada por pixels (baseada no prompt)
            ctx.fillStyle = "#000"; ctx.fillRect(0,0,400,400);
            
            for(let i=0; i<5000; i++) {
                setTimeout(() => {
                    ctx.fillStyle = `hsl(${Math.random()*360}, 70%, 50%)`;
                    if(instructions.includes("azul")) ctx.fillStyle = `rgb(0, ${Math.random()*100+155}, 255)`;
                    if(instructions.includes("fogo")) ctx.fillStyle = `rgb(255, ${Math.random()*150}, 0)`;
                    
                    const x = Math.random() * 400;
                    const y = Math.random() * 400;
                    ctx.beginPath();
                    ctx.arc(x, y, Math.random()*3, 0, Math.PI*2);
                    ctx.fill();
                }, i * 0.1);
            }
            return canvas;
        }

        function handleSend() {
            const text = userInput.value.trim();
            if (!text && !selectedImgBase64) return;

            // Renderizar Mensagem Usu√°rio
            const wrapper = document.createElement('div');
            wrapper.className = 'msg-wrapper user-wrapper';
            wrapper.innerHTML = `
                <div class="msg user-msg">${selectedImgBase64 ? '<img src="'+selectedImgBase64+'" class="preview-img"><br>' : ''}${text}</div>
                <div class="tools">
                    <button class="tool-btn" onclick="this.closest('.msg-wrapper').remove()">APAGAR</button>
                </div>`;
            chatBox.appendChild(wrapper);

            // Verificar se √© pedido de desenho
            if (text.toLowerCase().includes("desenha") || text.toLowerCase().includes("cria uma imagem")) {
                const aiWrap = createAIWrapper("Processando motor gr√°fico de pixels...");
                chatBox.appendChild(aiWrap);
                setTimeout(() => {
                    aiWrap.querySelector('.msg').innerHTML = "<b>Arte Neural Gerada:</b>";
                    aiWrap.querySelector('.msg').appendChild(drawNeuralArt(text));
                }, 1500);
            } else {
                processAI(text);
            }
            
            clearUpload();
            userInput.value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function processAI(query) {
            const aiWrap = createAIWrapper("IA-Z√âNIA est√° processando...");
            chatBox.appendChild(aiWrap);

            try {
                const system = `Seu nome √© IA-Z√âNIA. Desenvolvedor: in√°cio.u.daniel. Voc√™ pode analisar imagens (se enviadas em base64) e responder de forma inteligente.`;
                const prompt = selectedImgBase64 ? `[IMAGEM_ENVIADA] ${query}` : query;
                
                const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(system + "\n" + prompt)}?model=openai`);
                const result = await res.text();
                
                aiWrap.querySelector('.msg').innerHTML = result.replace(/\n/g, '<br>');
            } catch (e) {
                aiWrap.querySelector('.msg').innerText = "Erro na rede neural.";
            }
        }

        function createAIWrapper(initialText) {
            const wrap = document.createElement('div');
            wrap.className = 'msg-wrapper ai-wrapper';
            wrap.innerHTML = `
                <div class="msg ai-msg text-sm">${initialText}</div>
                <div class="tools">
                    <button class="tool-btn" onclick="sendFeedback('Like')">üëç</button>
                    <button class="tool-btn" onclick="sendFeedback('Dislike')">üëé</button>
                    <button class="tool-btn" onclick="retryMsg(this)">REENVIAR</button>
                    <button class="tool-btn" onclick="this.closest('.msg-wrapper').remove()">REMOVER</button>
                </div>`;
            return wrap;
        }

        function sendFeedback(type) {
            const email = "danielinacio475@gmail.com";
            const subject = encodeURIComponent(`Feedback IA-Z√âNIA: ${type}`);
            const body = encodeURIComponent(`O usu√°rio deu ${type} em uma resposta da IA.`);
            window.open(`mailto:${email}?subject=${subject}&body=${body}`);
            alert("Obrigado pelo feedback! Seu app de e-mail ser√° aberto.");
        }

        function retryMsg(btn) {
            const text = btn.closest('.msg-wrapper').previousElementSibling.innerText;
            btn.closest('.msg-wrapper').remove();
            processAI(text);
        }

        userInput.addEventListener('keypress', (e) => e.key === 'Enter' && handleSend());
    </script>
</body>
</html>
