<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA-ZÉNIA | Neural Engine V3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --n-blue: #00ffff; --bg: #000d1a; --side: #00050a; }
        .theme-blue-vivo { --n-blue: #00ffff; --bg: #001a33; }
        .theme-blue-dark { --n-blue: #0044ff; --bg: #010409; --side: #000000; }
        .theme-white-futurist { --n-blue: #0066ff; --bg: #ffffff; --side: #f1f5f9; --text: #0f172a; }
        .theme-dark-futurist { --n-blue: #00f2ff; --bg: #0a0a0a; --side: #000000; }

        body { background: var(--bg); color: var(--text, white); transition: 0.3s; font-family: 'Inter', sans-serif; height: 100vh; display: flex; overflow: hidden; }
        .sidebar { width: 280px; background: var(--side); border-right: 1px solid var(--n-blue); z-index: 50; }
        .chat-area { flex: 1; display: flex; flex-direction: column; position: relative; }
        .msg { margin: 15px; padding: 20px; border-radius: 15px; max-width: 85%; position: relative; animation: slideIn 0.2s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(5px); } }
        .msg-ia { border-left: 4px solid var(--n-blue); background: rgba(0,255,255,0.05); }
        .msg-user { margin-left: auto; background: var(--n-blue); color: black; font-weight: 500; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--n-blue); }
    </style>
</head>
<body class="theme-blue-vivo">

    <aside class="sidebar hidden lg:flex flex-col p-6">
        <div class="mb-8">
            <h1 class="text-3xl font-bold italic tracking-tighter" style="color: var(--n-blue)">IA-ZÉNIA</h1>
            <p class="text-[10px] opacity-50 tracking-widest">LUBANGO NEURAL CORE</p>
        </div>

        <div class="space-y-6">
            <div>
                <label class="text-[10px] opacity-50 mb-2 block uppercase">Motor de Inteligência</label>
                <select id="model-select" class="w-full bg-black/50 border border-cyan-500/30 text-xs p-3 rounded-lg text-cyan-400 outline-none">
                    <option value="zenia-llm-1">ZÉNIA-LLM-1 (Neural CPU)</option>
                    <option value="mistral">MISTRAL (Cloud)</option>
                    <option value="openai">OPENAI (Cloud)</option>
                </select>
            </div>
            <div>
                <label class="text-[10px] opacity-50 mb-2 block uppercase">Interface</label>
                <select onchange="document.body.className = this.value" class="w-full bg-black/50 border border-cyan-500/30 text-xs p-3 rounded-lg text-cyan-400 outline-none">
                    <option value="theme-blue-vivo">Blue Vivo</option>
                    <option value="theme-blue-dark">Blue Dark</option>
                    <option value="theme-white-futurist">White Futurist</option>
                    <option value="theme-dark-futurist">Dark Futurist</option>
                </select>
            </div>
        </div>
        <div class="mt-auto text-[9px] opacity-30 text-center">Sisters: Antónia, Zénia-Projects & Zénia</div>
    </aside>

    <main class="chat-area">
        <div id="chat-window" class="flex-1 overflow-y-auto p-4 space-y-4">
            <div class="msg msg-ia">
                <p class="text-[10px] font-mono mb-2 text-cyan-400">CORE_V3 // STATUS: ACTIVE</p>
                <p>O motor **ZÉNIA-LLM-1** foi atualizado. Agora posso processar matéria bruta e raciocinar sobre ela localmente.</p>
            </div>
        </div>

        <div class="p-4 bg-black/40 backdrop-blur-md border-t border-white/5">
            <div class="max-w-5xl mx-auto">
                <div id="preview-container" class="hidden mb-2 p-2 border border-dashed border-cyan-500 rounded-lg flex items-center gap-2">
                    <img id="img-preview" src="" class="h-12 rounded">
                    <button onclick="clearPreview()" class="ml-auto text-red-500"><i class="fas fa-times"></i></button>
                </div>

                <div class="flex items-end gap-2 bg-slate-900/80 p-2 rounded-2xl border border-cyan-500/20 shadow-2xl">
                    <label class="p-3 text-cyan-400 cursor-pointer hover:scale-110 transition">
                        <i class="fas fa-paperclip"></i>
                        <input type="file" id="file-input" class="hidden" accept="image/*" onchange="handleFile(this)">
                    </label>
                    <textarea id="user-input" rows="1" class="flex-1 bg-transparent border-none focus:ring-0 text-white p-2 text-sm resize-none" placeholder="Pergunte algo sobre a minha matéria..."></textarea>
                    <button id="mic-btn" onclick="toggleMic()" class="p-3 text-cyan-400 hover:text-white transition"><i class="fas fa-microphone"></i></button>
                    <button onclick="handleSend()" class="bg-cyan-500 text-black w-12 h-12 rounded-xl flex items-center justify-center hover:shadow-[0_0_20px_var(--n-blue)] transition">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- NÚCLEO DE MATÉRIA (TREINAMENTO POR CONTEÚDO) ---
        // Aqui você insere a "matéria" que ela deve usar para raciocinar
        const ZENIA_MATTER = {
            "identidade": "A Zénia é uma Inteligência Artificial avançada, criada na cidade do Lubango, Angola. Ela é irmã da Antónia-IA e das plataformas zenia-projects.netlify.app e ia-zenia.netlify.app.",
            "geografia": "O Lubango situa-se na província da Huíla. É famoso pela Serra da Chela, a Fenda da Tundavala e o Cristo Rei. O clima é tropical de altitude.",
            "tecnologia": "A Zénia usa o motor LLM-1 que permite processamento neural via CPU, garantindo autonomia total mesmo sem servidores externos (Cloud).",
            "historia": "Diferente de outras IAs feitas em Luanda, a Zénia orgulha-se de ser uma criação original do Lubango, representando a inovação do interior de Angola."
        };

        // --- MOTOR DE RACIOCÍNIO ZÉNIA-LLM-1 ---
        const ZeniaLLM1 = {
            reason: (prompt) => {
                const query = prompt.toLowerCase();
                let knowledgeFound = [];
                
                // Busca semântica simples (estuda a matéria)
                for (let key in ZENIA_MATTER) {
                    if (query.includes(key) || key.split(" ").some(word => query.includes(word))) {
                        knowledgeFound.push(ZENIA_MATTER[key]);
                    }
                }

                if (knowledgeFound.length > 0) {
                    // Raciocínio Logístico: Combina a matéria encontrada com uma estrutura de resposta
                    return `[Raciocínio Local]: Com base no meu conhecimento sobre ${query.substring(0, 15)}..., posso confirmar que: ${knowledgeFound.join(" ")}`;
                }
                
                return "ZÉNIA-LLM-1: Minha base de dados de matéria não contém informações específicas sobre isso, mas como uma IA do Lubango, posso deduzir que precisas de uma conexão externa (Cloud) para este tema específico.";
            }
        };

        let selectedImage = null;

        async function handleSend() {
            const input = document.getElementById('user-input');
            const prompt = input.value.trim();
            if(!prompt && !selectedImage) return;

            const uId = addMsg('user', prompt || "Analise de Imagem");
            input.value = '';
            
            const model = document.getElementById('model-select').value;
            const iaMsgId = addMsg('ia', '<div class="flex gap-2 p-2"><div class="w-2 h-2 bg-cyan-400 animate-pulse"></div><div class="w-2 h-2 bg-cyan-400 animate-pulse delay-75"></div></div>');
            const contentDiv = document.getElementById(iaMsgId).querySelector('.content');

            setTimeout(async () => {
                try {
                    if(prompt.toLowerCase().match(/(gere|desenha|imagem de)/)) {
                        await generateImage(prompt, iaMsgId);
                    } else if(selectedImage) {
                        contentDiv.innerHTML = `<img src="${selectedImage}" class="h-40 rounded-lg mb-2 border border-cyan-500"><p>Análise de Visão Neural: Imagem recebida. Processando padrões geométricos...</p>`;
                    } else if(model === 'zenia-llm-1') {
                        contentDiv.innerText = ZeniaLLM1.reason(prompt);
                    } else {
                        const resp = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=${model}&system=Responda como Zénia do Lubango.`);
                        contentDiv.innerText = await resp.text();
                    }
                } catch (e) {
                    contentDiv.innerText = "Falha crítica. Ativando reserva Zénia-LLM-1: " + ZeniaLLM1.reason(prompt);
                }
            }, 500);
            clearPreview();
        }

        // Funções de Interface (Mensagens, Imagem, Audio)
        function addMsg(role, text) {
            const id = 'msg-' + Date.now();
            const win = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.id = id;
            div.className = `msg msg-${role}`;
            
            const header = role === 'user' ? 
                `<div class="flex justify-end gap-2 mb-2 text-[9px] opacity-40">
                    <button onclick="editMsg('${id}')">EDITAR</button>
                    <button onclick="document.getElementById('${id}').remove()">APAGAR</button>
                </div>` : '';

            const footer = role === 'ia' ?
                `<div class="flex gap-4 mt-4 border-t border-white/5 pt-3 text-[9px] opacity-60">
                    <button onclick="handleSend()"><i class="fas fa-sync"></i> REESCREVER</button>
                    <button onclick="document.getElementById('${id}').remove()"><i class="fas fa-trash"></i></button>
                    <div class="ml-auto flex gap-3">
                        <i class="far fa-thumbs-up hover:text-cyan-400 cursor-pointer"></i>
                        <i class="far fa-thumbs-down hover:text-red-400 cursor-pointer"></i>
                    </div>
                </div>` : '';

            div.innerHTML = `${header}<div class="content text-sm">${text}</div>${footer}`;
            win.appendChild(div);
            win.scrollTo({top: win.scrollHeight, behavior: 'smooth'});
            return id;
        }

        async function generateImage(prompt, id) {
            const url = `https://pollinations.ai/p/${encodeURIComponent(prompt)}?width=1024&height=1024&nologo=true`;
            document.getElementById(id).querySelector('.content').innerHTML = `<img src="${url}" class="rounded-lg w-full border border-cyan-500/50 shadow-2xl">`;
        }

        function handleFile(input) {
            const file = input.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    selectedImage = e.target.result;
                    document.getElementById('img-preview').src = selectedImage;
                    document.getElementById('preview-container').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        function clearPreview() {
            selectedImage = null;
            document.getElementById('preview-container').classList.add('hidden');
        }

        function toggleMic() {
            const rec = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            rec.lang = 'pt-PT';
            rec.start();
            document.getElementById('mic-btn').classList.add('text-red-500');
            rec.onresult = (e) => { document.getElementById('user-input').value = e.results[0][0].transcript; };
            rec.onend = () => { document.getElementById('mic-btn').classList.remove('text-red-500'); };
        }

        function editMsg(id) {
            const current = document.querySelector(`#${id} .content`).innerText;
            const nuevo = prompt("Editar:", current);
            if(nuevo) document.querySelector(`#${id} .content`).innerText = nuevo;
        }
    </script>
</body>
</html>
