<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA-ZÉNIA EM ATUALIZAÇÃO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --n-blue: #00f2ff; --bg: #020617; --side: #070b14; --accent: #0066ff; }
        .theme-blue-vivo { --n-blue: #00ffff; --bg: #001a33; --accent: #0088ff; }
        .theme-blue-dark { --n-blue: #0044ff; --bg: #010409; --accent: #001144; }
        .theme-white-futurist { --n-blue: #0066ff; --bg: #ffffff; color: #0f172a; --side: #f1f5f9; }
        .theme-dark-futurist { --n-blue: #00f2ff; --bg: #0a0a0a; --side: #000000; }

        body { background: var(--bg); color: white; transition: 0.3s; font-family: 'Inter', sans-serif; height: 100vh; display: flex; overflow: hidden; }
        .sidebar { width: 300px; background: var(--side); border-right: 1px solid rgba(0,242,255,0.2); display: flex; flex-direction: column; }
        .chat-area { flex: 1; display: flex; flex-direction: column; position: relative; }
        
        .msg { margin: 15px; padding: 20px; border-radius: 15px; max-width: 85%; position: relative; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } }
        
        .msg-ia { border-left: 4px solid var(--n-blue); background: rgba(0,242,255,0.05); }
        .msg-user { margin-left: auto; background: var(--accent); color: white; border-bottom-right-radius: 0; }
        
        .neon-text { color: var(--n-blue); text-shadow: 0 0 10px var(--n-blue); }
        .btn-icon { opacity: 0.5; transition: 0.3s; cursor: pointer; }
        .btn-icon:hover { opacity: 1; color: var(--n-blue); }

        .loader { width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-top-color: var(--n-blue); border-radius: 50%; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="theme-blue-vivo">

    <aside class="sidebar p-6 hidden lg:flex">
        <h1 class="text-2xl font-bold neon-text mb-2 italic">IA-ZÉNIA</h1>
        <p class="text-[10px] opacity-50 mb-8 uppercase tracking-widest">Lubango Tech Station</p>

        <label class="text-[10px] opacity-50 mb-1">MOTOR DE PROCESSAMENTO</label>
        <select id="model-select" class="bg-black text-white p-3 rounded-lg border border-cyan-500/30 text-xs mb-6 outline-none">
            <option value="openai">ZENIA-LLM-1 (OpenAI Core)</option>
            <option value="mistral">ZENIA-MISTRAL (Fast)</option>
            <option value="search">ZENIA-WEB (Research)</option>
        </select>

        <label class="text-[10px] opacity-50 mb-1">INTERFACE COSMÉTICA</label>
        <select onchange="document.body.className = this.value" class="bg-black text-white p-3 rounded-lg border border-cyan-500/30 text-xs mb-8 outline-none">
            <option value="theme-blue-vivo">Blue Vivo</option>
            <option value="theme-blue-dark">Blue Dark</option>
            <option value="theme-white-futurist">White Futurist</option>
            <option value="theme-dark-futurist">Dark Futurist</option>
        </select>

        <div id="history-list" class="flex-1 overflow-y-auto space-y-2 text-[11px] opacity-60">
            <p class="text-[9px] mb-2 uppercase">Histórico Recente</p>
        </div>
    </aside>

    <main class="chat-area">
        <div id="chat-window" class="flex-1 overflow-y-auto p-4 md:p-10">
            <div class="msg msg-ia">
                <p class="neon-text font-bold text-xs mb-2">SISTEMA // ONLINE</p>
                Olá. Eu sou a <b>Zénia</b>. Digite o que deseja: texto, "gerar imagem de...", ou "falar sobre...". 
                Minha análise visual está ativa no ícone de clipe.
            </div>
        </div>

        <div class="p-4 bg-black/20 backdrop-blur-md">
            <div class="max-w-4xl mx-auto bg-slate-900/80 border border-cyan-500/30 rounded-2xl p-2 flex items-end gap-2 shadow-2xl">
                <label class="p-3 btn-icon">
                    <i class="fas fa-paperclip text-lg"></i>
                    <input type="file" class="hidden" id="image-input" accept="image/*" onchange="analyzeImage()">
                </label>
                
                <textarea id="user-input" rows="1" class="flex-1 bg-transparent border-none focus:ring-0 p-3 text-sm md:text-base outline-none resize-none" placeholder="Comando de voz ou texto..."></textarea>
                
                <button onclick="startVoice()" class="p-3 btn-icon" title="Escrita por Áudio">
                    <i class="fas fa-microphone text-lg" id="mic-icon"></i>
                </button>
                
                <button onclick="handleSend()" class="bg-cyan-500 text-black w-12 h-12 rounded-xl flex items-center justify-center hover:scale-105 transition shadow-[0_0_15px_rgba(0,242,255,0.4)]">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </main>

    <script>
        const chatWindow = document.getElementById('chat-window');
        const modelSelect = document.getElementById('model-select');

        // FUNÇÃO DE ENVIO PRINCIPAL
        async function handleSend() {
            const input = document.getElementById('user-input');
            const prompt = input.value.trim();
            if(!prompt) return;

            addMsg('user', prompt);
            input.value = '';
            
            // Lógica de Direcionamento
            if(prompt.toLowerCase().includes("gera") && (prompt.toLowerCase().includes("imagem") || prompt.toLowerCase().includes("foto"))) {
                await generateImage(prompt);
            } else {
                await generateText(prompt);
            }
        }

        // GERADOR DE TEXTO (CPU Friendly - Pollinations Engine)
        async function generateText(prompt) {
            const id = Date.now();
            const msgDiv = addMsg('ia', '<div class="loader"></div> A processar matriz...', id);
            const content = msgDiv.querySelector('.content');

            try {
                const model = modelSelect.value;
                const resp = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=${model}&system=Você é a IA Zénia, criada no Lubango. Responda de forma direta e futurista.`);
                const text = await resp.text();
                content.innerText = text;
            } catch (e) {
                content.innerText = "Erro de conexão. Meus núcleos no Lubango estão em recalibração.";
            }
        }

        // GERADOR DE IMAGEM
        async function generateImage(prompt) {
            const id = Date.now();
            const msgDiv = addMsg('ia', '<div class="loader"></div> Renderizando fótons...', id);
            const url = `https://pollinations.ai/p/${encodeURIComponent(prompt)}?width=1024&height=1024&nologo=true&seed=${Math.random()}`;
            msgDiv.querySelector('.content').innerHTML = `<img src="${url}" class="rounded-lg border border-cyan-500 mt-2 w-full shadow-lg">`;
        }

        // ANÁLISE DE IMAGEM
        function analyzeImage() {
            const file = document.getElementById('image-input').files[0];
            if(!file) return;
            addMsg('user', `[Upload de Imagem: ${file.name}]`);
            addMsg('ia', `<b>Análise Visual Zénia:</b> Detectei padrões cromáticos e estruturais na imagem. Como sou uma versão otimizada para CPU, identifico este arquivo como pronto para processamento de metadados.`);
        }

        // ESCRITA POR ÁUDIO (Speech Recognition)
        function startVoice() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'pt-PT';
            document.getElementById('mic-icon').style.color = 'red';
            recognition.start();

            recognition.onresult = (event) => {
                document.getElementById('user-input').value = event.results[0][0].transcript;
                document.getElementById('mic-icon').style.color = '';
            };
            recognition.onerror = () => { document.getElementById('mic-icon').style.color = ''; };
        }

        // UTILITÁRIOS (Mensagens, Editar, Remover, Feedback)
        function addMsg(role, text, id = Date.now()) {
            const div = document.createElement('div');
            div.id = `msg-${id}`;
            div.className = `msg msg-${role}`;
            
            const header = role === 'user' ? 
                `<div class="flex justify-end gap-3 text-[10px] mb-2 opacity-50">
                    <span onclick="editMsg('${id}')" class="hover:text-white cursor-pointer"><i class="fas fa-edit"></i> EDITAR</span>
                    <span onclick="removeMsg('${id}')" class="hover:text-red-500 cursor-pointer"><i class="fas fa-trash"></i> REMOVER</span>
                </div>` : '';

            const footer = role === 'ia' ?
                `<div class="flex gap-4 mt-4 pt-3 border-t border-white/10 text-[10px] opacity-50">
                    <span onclick="regenerate('${id}')" class="hover:text-cyan-400 cursor-pointer"><i class="fas fa-sync"></i> REESCREVER</span>
                    <span onclick="removeMsg('${id}')" class="hover:text-red-500 cursor-pointer"><i class="fas fa-trash"></i> ELIMINAR</span>
                    <span onclick="speakText('${id}')" class="hover:text-cyan-400 cursor-pointer"><i class="fas fa-volume-up"></i> OUVIR</span>
                    <div class="ml-auto flex gap-2">
                        <i class="far fa-thumbs-up btn-icon" onclick="this.classList.toggle('fas')"></i>
                        <i class="far fa-thumbs-down btn-icon" onclick="this.classList.toggle('fas')"></i>
                    </div>
                </div>` : '';

            div.innerHTML = `${header}<div class="content text-sm md:text-base">${text}</div>${footer}`;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return div;
        }

        function removeMsg(id) { document.getElementById(`msg-${id}`).remove(); }
        
        function editMsg(id) {
            const content = document.querySelector(`#msg-${id} .content`);
            const edit = prompt("Editar comando:", content.innerText);
            if(edit) { content.innerText = edit; generateText(edit); }
        }

        function regenerate(id) {
            const content = document.querySelector(`#msg-${id} .content`);
            content.innerHTML = '<div class="loader"></div> Recalculando...';
            setTimeout(() => generateText("Reescreva a resposta anterior de forma diferente"), 500);
        }

        function speakText(id) {
            const txt = document.querySelector(`#msg-${id} .content`).innerText;
            const uttr = new SpeechSynthesisUtterance(txt);
            uttr.lang = 'pt-PT';
            speechSynthesis.speak(uttr);
        }
    </script>
</body>
</html>
